# Домашнее задание к занятию "Компьютерные сети.Лекция 2"

## 1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

- Linux

       ip link show
       ifconfig -a

- Windows

       ipconfig /all

## 2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

LLDP – протокол для обмена информацией между соседними устройствами, позволяет определить к какому порту коммутатора подключен сервер.

Пакет lldpd, команды:

      root@sysadm-fs:/home/vagrant# lldpctl
      -------------------------------------------------------------------------------
      LLDP neighbors:
      -------------------------------------------------------------------------------

Так же для IPv6 есть протокол NDP, для обнаружения соседей, имеет команды:

      vagrant@sysadm-fs:~$ ip -6 neighbour

## 3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

Технология VLAN

Используются пакеты vconfig, vlan, iproute2

Команда:

       vagrant@sysadm-fs:~$ sudo ip link add link eth0 name new_eth type vlan id 1400
       vagrant@sysadm-fs:~$ ip -br l
       lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP>
       eth0             UP             08:00:27:a2:6b:fd <BROADCAST,MULTICAST,UP,LOWER_UP>
       new_eth@eth0     DOWN           08:00:27:a2:6b:fd <BROADCAST,MULTICAST>

Пример конфига:

     auto vlan1400
     iface vlan1400 inet static
             address 192.168.1.1
             netmask 255.255.255.0
             vlan_raw_device eth0

## 4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

### mode=0 (balance-rr)

Этот режим используется по-умолчанию, если в настройках не указано другое. balance-rr обеспечивает балансировку нагрузки и отказоустойчивость. В данном режиме пакеты отправляются "по кругу" от первого интерфейса к последнему и сначала. Если выходит из строя один из интерфейсов, пакеты отправляются на остальные оставшиеся.При подключении портов к разным коммутаторам, требует их настройки.

### mode=1 (active-backup)

При active-backup один интерфейс работает в активном режиме, остальные в ожидающем. Если активный падает, управление передается одному из ожидающих. Не требует поддержки данной функциональности от коммутатора.

### mode=2 (balance-xor)

Передача пакетов распределяется между объединенными интерфейсами по формуле ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. Один и тот же интерфейс работает с определённым получателем. Режим даёт балансировку нагрузки и отказоустойчивость.

### mode=3 (broadcast)

Происходит передача во все объединенные интерфейсы, обеспечивая отказоустойчивость.

### mode=4 (802.3ad)

Это динамическое объединение портов. В данном режиме можно получить значительное увеличение пропускной способности как входящего так и исходящего трафика, используя все объединенные интерфейсы. Требует поддержки режима от коммутатора, а так же (иногда) дополнительную настройку коммутатора.

### mode=5 (balance-tlb)

Адаптивная балансировка нагрузки. При balance-tlb входящий трафик получается только активным интерфейсом, исходящий - распределяется в зависимости от текущей загрузки каждого интерфейса. Обеспечивается отказоустойчивость и распределение нагрузки исходящего трафика. Не требует специальной поддержки коммутатора.

### mode=6 (balance-alb)

Адаптивная балансировка нагрузки (более совершенная). Обеспечивает балансировку нагрузки как исходящего (TLB, transmit load balancing), так и входящего трафика (для IPv4 через ARP). Не требует специальной поддержки коммутатором, но требует возможности изменять MAC-адрес устройства.

Пример конфига:

     auto bond0

     iface bond0 inet static
         address 10.31.1.5
         netmask 255.255.255.0
         network 10.31.1.0
         gateway 10.31.1.254
         bond-slaves eth0 eth1
         bond-mode active-backup
         bond-miimon 100
         bond-downdelay 200
         bond-updelay 200

## 5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

      vagrant@sysadm-fs:/etc/network$ ipcalc 10.0.0.1/29
      Hosts/Net: 6                     Class A, Private Internet

Из маски /24 можно получить 32 подсети с маской /29

       vagrant@sysadm-fs:/etc/network$ ipcalc 10.10.10.0/24 /29
       Subnets:   32

Примеры:

        31.
       Network:   10.10.10.240/29      00001010.00001010.00001010.11110 000
       HostMin:   10.10.10.241         00001010.00001010.00001010.11110 001
       HostMax:   10.10.10.246         00001010.00001010.00001010.11110 110
       Broadcast: 10.10.10.247         00001010.00001010.00001010.11110 111
       Hosts/Net: 6                     Class A, Private Internet
       
        32.
       Network:   10.10.10.248/29      00001010.00001010.00001010.11111 000
       HostMin:   10.10.10.249         00001010.00001010.00001010.11111 001
       HostMax:   10.10.10.254         00001010.00001010.00001010.11111 110
       Broadcast: 10.10.10.255         00001010.00001010.00001010.11111 111
       Hosts/Net: 6                     Class A, Private Internet

## 6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

Можно взять из:
100.64.0.0 — 100.127.255.255 (маска подсети: 255.192.0.0 или /10) Carrier-Grade NAT.

Маска будет:

       vagrant@sysadm-fs:/etc/network$ ipcalc 100.64.0.0/26
       Address:   100.64.0.0           01100100.01000000.00000000.00 000000
       Netmask:   255.255.255.192 = 26 11111111.11111111.11111111.11 000000
       Wildcard:  0.0.0.63             00000000.00000000.00000000.00 111111
       =>
       Network:   100.64.0.0/26        01100100.01000000.00000000.00 000000
       HostMin:   100.64.0.1           01100100.01000000.00000000.00 000001
       HostMax:   100.64.0.62          01100100.01000000.00000000.00 111110
       Broadcast: 100.64.0.63          01100100.01000000.00000000.00 111111
       Hosts/Net: 62                    Class A

## 7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

- Проверить таблицу:

    Linux: ip neigh, arp -n

    Windows: arp -a

- Очистить кеш:

    Linux: ip neigh flush

    Windows: arp -d *

- Удалить один IP:

    Linux: ip neigh delete <IP> dev <INTERFACE>, arp -d <IP>

    Windows: arp -d <IP>
